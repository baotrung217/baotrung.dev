<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

	<!-- block search indexing -->
	<meta name="robots" content="noindex">
	<meta name="googlebot" content="noindex">

  <!-- bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" async>

  <!-- fontawesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" async>

  <!-- google fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin async >
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&display=swap" rel="stylesheet" crossorigin async>
  <link href="https://fonts.googleapis.com/css?family=Livvic:400,400i,500,500i,600&display=swap&subset=vietnamese" rel="stylesheet" crossorigin async>
  <link href="https://fonts.googleapis.com/css?family=Lobster&display=swap" rel="stylesheet" crossorigin async>

  <link rel="alternate" hreflang="en" href="/data-preprocessing-cleaning" async />

  <link rel="shortcut icon" type="image/x-icon" href="/img/avatar-icon.ico" async>
  <meta name="author" content="Nguyá»…n Báº£o Trung" />

  <title>
    
      Trung | Data Processing & Cleaning
    
  </title>

  

  <!-- feed -->
  <link rel="alternate" type="application/rss+xml" title="Nguyá»…n Báº£o Trung - " href="/feed.xml" async />

  <!-- page (internal) -->
  

  <!-- layout (internal) -->
  
    
      <link rel="stylesheet" href="/css/main.css" async />
    
      <link rel="stylesheet" href="/css/rouge-thi.css" async />
    
  
  

    <!-- Facebook OpenGraph tags -->
  

  
    <meta property="fb:admins" content="baotrung217zzz"/>
  

  
    <meta property="og:title" content="Data Processing & Cleaning" />
  

  
    <meta property="og:description" content="Libraries Other tasks Things need to be checked Deal with columns Remove or Keep some Rename columns Make index Drop duplicates Couple different columns Deal with missing values NaN Drop NaN values Fill NaN with others Do with conditions Work with text data In this note, I use df as...">
  


  <meta property="og:type" content="website" />

  
    <meta property="og:url" content="http://localhost:4000/data-preprocessing-cleaning" />
    <link rel="canonical" href="http://localhost:4000/data-preprocessing-cleaning" async />
  

  <meta property="og:image" content="http://localhost:4000/img/background.png" />
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="1234">
  <meta property="og:image:height" content="592">

  

  

  

  

</head>


<body>
  <script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '',
      xfbml      : true,
      version    : 'v3.1'
    });
  
    FB.AppEvents.logPageView();
  
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
  <header>
    <nav class="navbar navbar-dark nav-bg navbar-custom fixed-top">
  <div class="container">
    <div class="col-12 col-lg-10 offset-lg-1">
      <div class="nav-container">
        <a class="nav-item" href="http://localhost:4000/">
          <i style="color: #ffeead;" class="fas fa-home" aria-hidden="true"></i>
          <span>Home</span>
        </a>
        <a class="nav-item" href="http://localhost:4000/about">
          <i style="color: #e97c8e;" class="fas fa-fire" aria-hidden="true"></i>
          <span>Me</span>
        </a>
        <a class="nav-item" href="http://localhost:4000/notes">
          <i style="color: #93ceff;" class="fas fa-edit" aria-hidden="true"></i>
          <span>Notes</span>
        </a>
        <div class="nav-search">
          <form action="http://localhost:4000/search" method="get">
            <button class="nav-search-submit" type="submit">
              <i class="fa fa-search" aria-hidden="true"></i>
            </button>
            <input name="q" class="nav-search-input" type="search" placeholder="search notes..." aria-label="search notes...">
          </form>
        </div>
        <a class="nav-item nav-github" href="https://github.com/baotrung217" target="_blank">
          <i class="fab fa-github"></i>
        </a>
    </div>
    </div>
  </div>
</nav>

  </header>

  
  <header class="header">
    <div class="container">
      <div class="row align-items-center justify-content-center">
        <div class="col-md-8 header-content">
          
          
            <div class="icon-photo">
              <img src="http://localhost:4000/img/header/data-processing.png">
            </div>
          
          <h1 class="post-title">
            Data Processing & Cleaning
          </h1>
          
            <div class="tag-in-post">
              
              
                
                
                
                
                
                  <a href="/tags#data-processing">
                    data processing
                  </a>
                

              
            </div>
          
          <p>
            
              07 Dec 2019
                        
          </p>
        </div>
      </div>
    </div>
  </header>


<main role="main">
  <section class="section">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-12 col-lg-10 col-xl-9">
          <article  class="page-content ">
            <p style="font-style: italic; color: #777; font-size: 0.95rem; margin-bottom: 2rem;">
  Last modified on 01 May 2022.
</p>




<div id="toc">
  <div class="toc-content">
<ul id="markdown-toc">
  <li><a href="#libraries" id="markdown-toc-libraries">Libraries</a></li>
  <li><a href="#other-tasks" id="markdown-toc-other-tasks">Other tasks</a></li>
  <li><a href="#things-need-to-be-checked" id="markdown-toc-things-need-to-be-checked">Things need to be checked</a></li>
  <li><a href="#deal-with-columns" id="markdown-toc-deal-with-columns">Deal with columns</a>    <ul>
      <li><a href="#remove-or-keep-some" id="markdown-toc-remove-or-keep-some">Remove or Keep some</a></li>
      <li><a href="#rename-columns" id="markdown-toc-rename-columns">Rename columns</a></li>
      <li><a href="#make-index" id="markdown-toc-make-index">Make index</a></li>
      <li><a href="#drop-duplicates" id="markdown-toc-drop-duplicates">Drop duplicates</a></li>
      <li><a href="#couple-different-columns" id="markdown-toc-couple-different-columns">Couple different columns</a></li>
    </ul>
  </li>
  <li><a href="#deal-with-missing-values-nan" id="markdown-toc-deal-with-missing-values-nan">Deal with missing values <code class="language-plaintext highlighter-rouge">NaN</code></a>    <ul>
      <li><a href="#drop-nan-values" id="markdown-toc-drop-nan-values">Drop <code class="language-plaintext highlighter-rouge">NaN</code> values</a></li>
      <li><a href="#fill-nan-with-others" id="markdown-toc-fill-nan-with-others">Fill <code class="language-plaintext highlighter-rouge">NaN</code> with others</a></li>
    </ul>
  </li>
  <li><a href="#do-with-conditions" id="markdown-toc-do-with-conditions">Do with conditions</a></li>
  <li><a href="#work-with-text-data" id="markdown-toc-work-with-text-data">Work with text data</a></li>
</ul>

  </div>
</div>

<p>In this note, I use <code class="language-plaintext highlighter-rouge">df</code> as <code class="language-plaintext highlighter-rouge">DataFrame</code>, <code class="language-plaintext highlighter-rouge">s</code> as <code class="language-plaintext highlighter-rouge">Series</code>.</p>

<h2 id="libraries">Libraries</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span> <span class="c1"># import pandas package
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
</code></pre></div></div>

<h2 id="other-tasks">Other tasks</h2>

<div class="two-columns-list">
  <ul>
    <li><a href="http://localhost:4000/dataframe-overview">Data Overview</a></li>
    <li><a href="http://localhost:4000/data-aggregation">Data Aggregation</a></li>
    <li><a href="http://localhost:4000/data-combining">Data Combining</a></li>
  </ul>
</div>

<h2 id="things-need-to-be-checked">Things need to be checked</h2>

<div class="two-columns-list">
  <ol>
    <li><code class="language-plaintext highlighter-rouge">csv</code> file:
      <ol>
        <li>Values are separated by <code class="language-plaintext highlighter-rouge">,</code> of <code class="language-plaintext highlighter-rouge">;</code>?</li>
        <li>Encoding.</li>
        <li>Timestamp type.</li>
      </ol>
    </li>
    <li>Indexes are sorted?</li>
    <li>Indexes are continuous with step 1 (especially after using <code class="language-plaintext highlighter-rouge">.dropna()</code> or <code class="language-plaintext highlighter-rouge">.drop_duplicates</code>)?</li>
    <li>Are there <code class="language-plaintext highlighter-rouge">NaN</code> values? Drop them?</li>
    <li>Are there duplicates? Drop them?</li>
    <li>How many unique values?</li>
    <li>For <code class="language-plaintext highlighter-rouge">0/1</code> features, they have only 2 unique values (<code class="language-plaintext highlighter-rouge">0</code> and <code class="language-plaintext highlighter-rouge">1</code>)?</li>
    <li><code class="language-plaintext highlighter-rouge">KDE</code> plot to check the values distribution.</li>
    <li>The number of columns?</li>
    <li>Unique labels?</li>
    <li>Time series:
      <ol>
        <li>Time range.</li>
        <li>Time step.</li>
        <li>Timestampâ€™s type.</li>
        <li>Timezone.</li>
        <li>Timestamps are monotonic?</li>
      </ol>
    </li>
  </ol>
</div>

<h2 id="deal-with-columns">Deal with columns</h2>

<h3 id="remove-or-keep-some">Remove or Keep some</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># REMOVING COLUMNS
</span><span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'New'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># drop column 'New'
</span><span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'col1'</span><span class="p">,</span> <span class="s">'col2'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="flex-50">
  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ONLY KEEP SOME
</span><span class="n">kept_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s">'col1'</span><span class="p">,</span> <span class="s">'col2'</span><span class="p">,</span> <span class="p">...]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">kept_cols</span><span class="p">]</span>
</code></pre></div>  </div>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ALL EXCEPT SOME
</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">difference</span><span class="p">([</span><span class="s">'b'</span><span class="p">])]</span>
</code></pre></div>  </div>
</div>

<h3 id="rename-columns">Rename columns</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># IMPLICITLY
</span><span class="n">df</span><span class="p">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Surname'</span><span class="p">,</span> <span class="s">'Years'</span><span class="p">,</span> <span class="s">'Grade'</span><span class="p">,</span> <span class="s">'Location'</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># EXPLICITLY
</span><span class="n">df</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'Name'</span><span class="p">:</span> <span class="s">'Surname'</span><span class="p">,</span> <span class="s">'Ages'</span><span class="p">:</span> <span class="s">'Years'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># A SPECIFIC COLUMN
</span><span class="n">data</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'gdp'</span><span class="p">:</span><span class="s">'log(gdp)'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># RENAME INDEX COLUMN
</span><span class="n">df</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'new_name'</span>
</code></pre></div></div>

<h3 id="make-index">Make index</h3>

<div class="flex-50">
  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># COLUMN HAS UNIQUE VALUES?
</span><span class="n">df</span><span class="p">[</span><span class="s">'col'</span><span class="p">].</span><span class="n">is_unique</span> <span class="c1"># True if yes
</span></code></pre></div>  </div>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># INDEX -&gt; NORMAL COLUMN
</span><span class="n">df</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div>  </div>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># NORMAL COLUMN -&gt; INDEX
</span><span class="n">df</span><span class="p">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'column'</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">set_index</span><span class="p">([</span><span class="s">'col1'</span><span class="p">,</span> <span class="s">'col2'</span><span class="p">])</span>
</code></pre></div>  </div>
</div>

<h3 id="drop-duplicates">Drop duplicates</h3>

<p>ðŸ‘‰ <a href="/dataframe-overview#duplicates">Overview duplicates</a>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># check duplicates
</span><span class="n">df</span><span class="p">[</span><span class="s">'Student'</span><span class="p">].</span><span class="n">duplicated</span><span class="p">().</span><span class="nb">any</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># remove duplicates in some columns
</span><span class="n">df</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s">'col1'</span><span class="p">,</span> <span class="s">'col2'</span><span class="p">])</span>
<span class="c1"># use "ignore_index=True" if you wanna reset indexes to 0,1,...,n-1
</span></code></pre></div></div>

<h3 id="couple-different-columns">Couple different columns</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">df0</span><span class="p">[[</span><span class="s">'Date'</span><span class="p">,</span> <span class="s">'Heure'</span><span class="p">,</span> <span class="s">'tH (Â°C)'</span><span class="p">]].</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s">'timestamp'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'Date'</span><span class="p">]</span> <span class="o">+</span> <span class="s">' '</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s">'Heure'</span><span class="p">]</span>

<span class="c1"># if you use without `.copy()`
# WARNING: A value is trying to be set on a copy of a slice from a DataFrame.
</span></code></pre></div></div>

<h2 id="deal-with-missing-values-nan">Deal with missing values <code class="language-plaintext highlighter-rouge">NaN</code></h2>

<p>ðŸ‘‰ <a href="/dataframe-overview#missing-values">Overview missing values</a>.</p>

<h3 id="drop-nan-values">Drop <code class="language-plaintext highlighter-rouge">NaN</code> values</h3>

<p>Full reference of <code class="language-plaintext highlighter-rouge">dropna</code> is <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dropna.html">here</a>.</p>

<div class="flex-50">
  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Drop any rows which have any nans
</span><span class="n">df</span><span class="p">.</span><span class="n">dropna</span><span class="p">()</span>
</code></pre></div>  </div>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Drop if all values in that col are NA
</span><span class="n">df</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s">'all'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>  </div>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Drop columns that have any nans
</span><span class="n">df</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>  </div>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Only drop columns having min 90% non-NaNs
</span><span class="n">df</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">.</span><span class="mi">9</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>  </div>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Only keep rows having &gt;=2 non-NA values
</span><span class="n">df</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">thresh</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>  </div>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Only consider some cols
</span><span class="n">df</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s">'col1'</span><span class="p">,</span> <span class="s">'col2'</span><span class="p">])</span>
</code></pre></div>  </div>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># multi-index
</span><span class="n">df</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="s">'a'</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">'b'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s">'a'</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s">'b'</span><span class="p">)])</span>

<span class="c1"># consider all cols '1' and '2'
</span><span class="n">df</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[[],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]].</span><span class="n">columns</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="fill-nan-with-others">Fill <code class="language-plaintext highlighter-rouge">NaN</code> with others</h3>

<p>Check other methods of <code class="language-plaintext highlighter-rouge">fillna</code> <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html">here</a>.</p>

<div class="flex-50">
  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Fill NaN with ' '
</span><span class="n">df</span><span class="p">[</span><span class="s">'col'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'col'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="s">' '</span><span class="p">)</span>
</code></pre></div>  </div>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Fill NaN with 99
</span><span class="n">df</span><span class="p">[</span><span class="s">'col'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'col'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
</code></pre></div>  </div>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># mean / median of each column
</span><span class="n">df</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">mean</span><span class="p">())</span>
</code></pre></div>  </div>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Fill NaN with the mean of the column
</span><span class="n">df</span><span class="p">[</span><span class="s">'col'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'col'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s">'col'</span><span class="p">].</span><span class="n">mean</span><span class="p">())</span>
</code></pre></div>  </div>

  <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Fill NA with mean of row
</span><span class="n">m</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">col</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</code></pre></div>  </div>
</div>

<h2 id="do-with-conditions">Do with conditions</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">if_this_condition_is_true</span><span class="p">,</span> <span class="n">do_this</span><span class="p">,</span> <span class="n">else_this</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s">'new_column'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'foo'</span><span class="p">,</span> <span class="s">'bar) # example
</span></code></pre></div></div>

<h2 id="work-with-text-data">Work with text data</h2>

<p>There are a lot of <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/text.html#method-summary">methods</a> we can work with text data (<code class="language-plaintext highlighter-rouge">pd.Series.str</code>). We can use it coupling with <a href="/regular-expression">regular expression</a>.</p>



<!-- <div class="box-error">
<h4>Notice an error?</h4>
Everything on this site is <a href="https://github.com/baotrung217/dinhanhthi.com" target="_blank">published</a> on Github. If you find something wrong, <a href="https://github.com/dinhanhthi/dinhanhthi.com/edit/master/_posts/data-science/2019-12-07-data-preprocessing-cleaning.md" target="_blank">just edit it</a> or <a href="mailto:baotrung217@gmail.com?subject=Suggest to edit post 'Data Processing & Cleaning'">tell me</a> about it.
</div> -->

<div class="sec-comment">

  

  <button class="btn btn-info w-100" id="show-comments" onclick="load_comment();return false;">
    If you find something wrong or need a comment, click here.
  </button>

  <div id='comment-box' style="display: none;">
    <script src="https://utteranc.es/client.js"
            repo="dinhanhthi/dinhanhthi.com"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
  </div>

  <script>
    var comment_loaded = false;
    function load_comment() {
        if (!comment_loaded)  {
            comment_loaded = true;
            document.getElementById("show-comments").style.display = "none";
            document.getElementById("comment-box").style.display = "block";
        }
    }
  </script>
</div>

<div class="modal fade" id="imagemodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg modal-xl">
    <div class="modal-content">
      <div class="modal-body">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <img src="" class="imagepreview" style="width: 100%;" >
      </div>
    </div>
  </div>
</div>



          </article >
        </div>
      </div>
    </div>
  </section>
</main>



  <footer class="footer">
    <div class="container">
  <div class="row justify-content-center">
    <div class="col-12 col-md-8 col-lg-6 text-center p-3">
      <div class="footer-info">
        <a href="https://baotrung.dev" target="_blank">Trung</a>
        &nbsp;&copy;&nbsp;
        2022
        &nbsp;&bull;&nbsp;
        <a href="http://localhost:4000/about-the-notes">
          About the notes
        </a>
        &nbsp;&bull;&nbsp;
        <a href="https://pobo.dinhanhthi.com" target="_blank">
          Po Bo
        </a>
        &nbsp;&bull;&nbsp;
        <a href="/for-me-only">
          For me only
        </a>
        &nbsp;&bull;&nbsp;
        <a class="donate" href="http://localhost:4000/donate">
          Support Trung
        </a>
      </div>
    </div>
  </div>
</div>

  </footer>

  





  

  <script src="https://code.jquery.com/jquery-1.10.1.min.js" integrity="sha256-SDf34fFWX/ZnUozXXEH0AeB+Ip3hvRsjLwp6QNTEb3k=" crossorigin="anonymous" async></script>

  <!-- scrolling-toc -->
  <script src="http://localhost:4000/js/scrolling-toc.js" type="text/javascript" async></script>

  <!-- bootstrap -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous" async></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous" async></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous" async></script>

  <script src="http://localhost:4000/js/click_to_zoom.js" async></script>

  <script src="http://localhost:4000/js/anchor.js" async></script>

</body>
</html>
