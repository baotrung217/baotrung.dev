<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

	<!-- block search indexing -->
	<meta name="robots" content="noindex">
	<meta name="googlebot" content="noindex">

  <!-- bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" async>

  <!-- fontawesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" async>

  <!-- google fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin async >
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&display=swap" rel="stylesheet" crossorigin async>
  <link href="https://fonts.googleapis.com/css?family=Livvic:400,400i,500,500i,600&display=swap&subset=vietnamese" rel="stylesheet" crossorigin async>
  <link href="https://fonts.googleapis.com/css?family=Lobster&display=swap" rel="stylesheet" crossorigin async>

  <link rel="alternate" hreflang="en" href="/gatsby-images" async />

  <link rel="shortcut icon" type="image/x-icon" href="/img/avatar-icon.ico" async>
  <meta name="author" content="Nguy·ªÖn B·∫£o Trung" />

  <title>
    
      Trung | Gatsby Images
    
  </title>

  

  <!-- feed -->
  <link rel="alternate" type="application/rss+xml" title="Nguy·ªÖn B·∫£o Trung - " href="/feed.xml" async />

  <!-- page (internal) -->
  

  <!-- layout (internal) -->
  
    
      <link rel="stylesheet" href="/css/main.css" async />
    
      <link rel="stylesheet" href="/css/rouge-thi.css" async />
    
  
  

    <!-- Facebook OpenGraph tags -->
  

  
    <meta property="fb:admins" content="baotrung217zzz"/>
  

  
    <meta property="og:title" content="Gatsby Images" />
  

  
    <meta property="og:description" content="Rule of thumb Type of images to be processed Single photo Insert directly, Using data/query Using absolute path SVG files Change favicon Multiple images from data file/folder Images‚Äô URLs stored in a JSON file Using YAML data file query as an input Get all images from a specific folder References...">
  


  <meta property="og:type" content="website" />

  
    <meta property="og:url" content="http://localhost:4000/gatsby-images" />
    <link rel="canonical" href="http://localhost:4000/gatsby-images" async />
  

  <meta property="og:image" content="http://localhost:4000/img/background.png" />
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="1234">
  <meta property="og:image:height" content="592">

  

  

  

  

</head>


<body>
  <script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '',
      xfbml      : true,
      version    : 'v3.1'
    });
  
    FB.AppEvents.logPageView();
  
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
  <header>
    <nav class="navbar navbar-dark nav-bg navbar-custom fixed-top">
  <div class="container">
    <div class="col-12 col-lg-10 offset-lg-1">
      <div class="nav-container">
        <a class="nav-item" href="http://localhost:4000/">
          <i style="color: #ffeead;" class="fas fa-home" aria-hidden="true"></i>
          <span>Home</span>
        </a>
        <a class="nav-item" href="http://localhost:4000/about">
          <i style="color: #e97c8e;" class="fas fa-fire" aria-hidden="true"></i>
          <span>Me</span>
        </a>
        <a class="nav-item" href="http://localhost:4000/notes">
          <i style="color: #93ceff;" class="fas fa-edit" aria-hidden="true"></i>
          <span>Notes</span>
        </a>
        <div class="nav-search">
          <form action="http://localhost:4000/search" method="get">
            <button class="nav-search-submit" type="submit">
              <i class="fa fa-search" aria-hidden="true"></i>
            </button>
            <input name="q" class="nav-search-input" type="search" placeholder="search notes..." aria-label="search notes...">
          </form>
        </div>
        <a class="nav-item nav-github" href="https://github.com/baotrung217" target="_blank">
          <i class="fab fa-github"></i>
        </a>
    </div>
    </div>
  </div>
</nav>

  </header>

  
  <header class="header">
    <div class="container">
      <div class="row align-items-center justify-content-center">
        <div class="col-md-8 header-content">
          
          
            <div class="icon-photo">
              <img src="http://localhost:4000/img/header/gatsby.png">
            </div>
          
          <h1 class="post-title">
            Gatsby Images
          </h1>
          
            <div class="tag-in-post">
              
              
                
                
                
                
                

              
                
                
                
                
                
                  <a href="/tags#gatsbyjs">
                    gatsbyjs
                  </a>
                

              
                
                
                
                
                
                  <a href="/tags#react">
                    react
                  </a>
                

              
                
                
                
                
                
                  <a href="/tags#static-site">
                    static site
                  </a>
                

              
            </div>
          
          <p>
            
              31 Dec 2019
                        
          </p>
        </div>
      </div>
    </div>
  </header>


<main role="main">
  <section class="section">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-12 col-lg-10 col-xl-9">
          <article  class="page-content ">
            <p style="font-style: italic; color: #777; font-size: 0.95rem; margin-bottom: 2rem;">
  Last modified on 01 May 2022.
</p>




<div id="toc">
  <div class="toc-content">
<ul id="markdown-toc">
  <li><a href="#rule-of-thumb" id="markdown-toc-rule-of-thumb">Rule of thumb</a></li>
  <li><a href="#type-of-images-to-be-processed" id="markdown-toc-type-of-images-to-be-processed">Type of images to be processed</a></li>
  <li><a href="#single-photo" id="markdown-toc-single-photo">Single photo</a>    <ul>
      <li><a href="#insert-directly" id="markdown-toc-insert-directly">Insert directly,</a></li>
      <li><a href="#using-dataquery" id="markdown-toc-using-dataquery">Using data/query</a></li>
      <li><a href="#using-absolute-path" id="markdown-toc-using-absolute-path">Using absolute path</a></li>
      <li><a href="#svg-files" id="markdown-toc-svg-files">SVG files</a></li>
    </ul>
  </li>
  <li><a href="#change-favicon" id="markdown-toc-change-favicon">Change favicon</a></li>
  <li><a href="#multiple-images-from-data-filefolder" id="markdown-toc-multiple-images-from-data-filefolder">Multiple images from data file/folder</a>    <ul>
      <li><a href="#images-urls-stored-in-a-json-file" id="markdown-toc-images-urls-stored-in-a-json-file">Images‚Äô URLs stored in a JSON file</a></li>
      <li><a href="#using-yaml-data-file" id="markdown-toc-using-yaml-data-file">Using YAML data file</a></li>
    </ul>
  </li>
  <li><a href="#query-as-an-input" id="markdown-toc-query-as-an-input"><code class="language-plaintext highlighter-rouge">query</code> as an input</a></li>
  <li><a href="#get-all-images-from-a-specific-folder" id="markdown-toc-get-all-images-from-a-specific-folder">Get all images from a specific folder</a></li>
  <li><a href="#references" id="markdown-toc-references">References</a></li>
</ul>

  </div>
</div>

<p>Because the post <a href="/gatsby-js">Gatsby 101</a> is too long, I write a separate post just for images in Gatsby.</p>

<h2 id="rule-of-thumb">Rule of thumb</h2>

<ul>
  <li>Static images (icon, logo, favicon): just <code class="language-plaintext highlighter-rouge">import</code> and use <code class="language-plaintext highlighter-rouge">img</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">svg</code> cannot be used with <code class="language-plaintext highlighter-rouge">childImageSharp</code>, just use <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> with its <code class="language-plaintext highlighter-rouge">publicURL</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">png</code>, <code class="language-plaintext highlighter-rouge">jpg</code> can be used with <code class="language-plaintext highlighter-rouge">&lt;Img&gt;</code> and <code class="language-plaintext highlighter-rouge">childImageSharp</code>.</li>
  <li>Data can be used: <code class="language-plaintext highlighter-rouge">json</code> or <code class="language-plaintext highlighter-rouge">yaml</code>, cannot use <code class="language-plaintext highlighter-rouge">js</code> for images.</li>
  <li>List of images are get up to <code class="language-plaintext highlighter-rouge">edges</code>. After <code class="language-plaintext highlighter-rouge">edges</code>, there are a loop of <code class="language-plaintext highlighter-rouge">node</code>s.</li>
  <li><code class="language-plaintext highlighter-rouge">query</code> components must placed in <code class="language-plaintext highlighter-rouge">&lt;StaticQuery /&gt;</code>.</li>
  <li>Different screen solution: use <code class="language-plaintext highlighter-rouge">fixed</code>.</li>
  <li>Different screen size: use <code class="language-plaintext highlighter-rouge">fluid</code>.</li>
  <li>Use <a href="http://localhost:8000/___graphql">http://localhost:8000/___graphql</a> to check the <code class="language-plaintext highlighter-rouge">query</code>.</li>
  <li>Use <code class="language-plaintext highlighter-rouge">{condition &amp;&amp; condition &amp;&amp; output}</code> instead of using <code class="language-plaintext highlighter-rouge">if..else...</code></li>
  <li>The relative path of images is compared with the path of data file where the urls are indicated.</li>
</ul>

<h2 id="type-of-images-to-be-processed">Type of images to be processed</h2>

<p>Read <a href="Ways to Organize and Prepare Images for a Blur-Up Effect Using Gatsby">this post</a> from CSS-Tricks to know which images should be processed, which ones should not.</p>

<ul>
  <li><strong>No processing required</strong>: ‚Äústatic images‚Äù, icons and logos, favicons üëâ We can <code class="language-plaintext highlighter-rouge">import</code> and use <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> to directly import them.</li>
  <li><strong>Process required</strong>: PNG, JPG files, gallery, ‚Ä¶</li>
</ul>

<h2 id="single-photo">Single photo</h2>

<p>Install stuffs following <a href="https://www.gatsbyjs.org/docs/gatsby-image/">this doc</a>,</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span> <span class="nt">--save</span> gatsby-image gatsby-plugin-sharp gatsby-transformer-sharp
</code></pre></div></div>

<h3 id="insert-directly">Insert directly,</h3>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">avatar</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">src/images/site/avatar.jpg</span><span class="dl">"</span>
<span class="kd">function</span> <span class="nx">Header</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="p">=</span><span class="si">{</span><span class="nx">logo</span><span class="si">}</span> <span class="na">alt</span><span class="p">=</span><span class="s">"Logo"</span> <span class="p">/&gt;</span>
<span class="p">}</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">Header</span>
</code></pre></div></div>

<h3 id="using-dataquery">Using data/query</h3>

<p>So that we can have the lazing loading / resizing / blur-up (traced placeholder) effects.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span> <span class="nt">--save</span> gatsby-image gatsby-transformer-sharp gatsby-plugin-sharp
</code></pre></div></div>

<p>Below technique is just for single photos.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// gatsby-config.js</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">...</span>
    <span class="dl">'</span><span class="s1">gatsby-plugin-sharp</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">gatsby-transformer-sharp</span><span class="dl">'</span><span class="p">,</span>
    <span class="p">{</span>
      <span class="na">resolve</span><span class="p">:</span> <span class="dl">'</span><span class="s1">gatsby-source-filesystem</span><span class="dl">'</span><span class="p">,</span>
      <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">images</span><span class="dl">'</span><span class="p">,</span>
        <span class="na">path</span><span class="p">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s2">`src`</span><span class="p">,</span> <span class="s2">`images`</span><span class="p">),</span>
      <span class="p">},</span>
    <span class="p">},</span>
  <span class="p">],</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// src/components/Header.js</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">StaticQuery</span><span class="p">,</span> <span class="nx">graphql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">gatsby</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Img</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">gatsby-image</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">Header</span> <span class="o">=</span> <span class="p">({</span> <span class="nx">data</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nt">header</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nc">Img</span> <span class="na">fluid</span><span class="p">=</span><span class="si">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">myAvatar</span><span class="p">.</span><span class="nx">childImageSharp</span><span class="p">.</span><span class="nx">fluid</span><span class="si">}</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">header</span><span class="p">&gt;</span>
<span class="p">)</span>

<span class="c1">// src/images/avatar.png</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">props</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nc">StaticQuery</span>
    <span class="na">query</span><span class="p">=</span><span class="si">{</span><span class="nx">graphql</span><span class="s2">`
      query {
        myAvatar: file(relativePath: { eq: "avatar.png" }) {
          childImageSharp {
            fluid(maxWidth: 150) {
              ...GatsbyImageSharpFluid
            }
          }
        }
      }
    `</span><span class="si">}</span>
    <span class="na">render</span><span class="p">=</span><span class="si">{</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">&lt;</span><span class="nc">Header</span> <span class="na">data</span><span class="p">=</span><span class="si">{</span><span class="nx">data</span><span class="si">}</span> <span class="si">{</span><span class="p">...</span><span class="nx">props</span><span class="si">}</span> <span class="p">/&gt;</span><span class="si">}</span>
  <span class="p">/&gt;</span>
<span class="p">)</span>
</code></pre></div></div>

<p>üëâ Most of tutorials like <a href="https://alligator.io/gatsbyjs/images-in-gatsby/">this</a> or <a href="https://codebushi.com/using-gatsby-image/">this</a> don‚Äôt talk about <a href="https://www.gatsbyjs.org/docs/static-query/"><code class="language-plaintext highlighter-rouge">StaticQuery</code></a> (Gatsby v2). I followed them but it didn‚Äôt work, we have to use <code class="language-plaintext highlighter-rouge">StaticQuery</code> to make things work! üëâ The reason is that the (old) page query can only be added to page components (in my try, I add in <code class="language-plaintext highlighter-rouge">Header.js</code> component). <code class="language-plaintext highlighter-rouge">StaticQuery</code> can be used as a replacement of page query, it can be added to any component.<sup><a href="https://www.gatsbyjs.org/docs/static-query/#how-staticquery-differs-from-page-query " target="_blank">[ref]</a></sup></p>

<p>üëâ There are 2 types:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">fixed</code>: has a set width and height and is for supporting <em>different screen resolutions</em>. It accepts <code class="language-plaintext highlighter-rouge">width</code> and <code class="language-plaintext highlighter-rouge">height</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">fluid</code>: has a max-width and sometimes a max-height, and will create multiple images for supporting <em>different screen sizes</em>.  It accepts <code class="language-plaintext highlighter-rouge">maxWidth</code> and <code class="language-plaintext highlighter-rouge">maxHeight</code>.</li>
</ul>

<p>You need to use them with fragments like <code class="language-plaintext highlighter-rouge">GatsbyImageSharpFixed_tracedSVG</code> or <code class="language-plaintext highlighter-rouge">GatsbyImageSharpFluid</code> (<a href="https://www.gatsbyjs.org/packages/gatsby-image/?=#fragments">more</a>).</p>

<h3 id="using-absolute-path">Using absolute path</h3>

<p>If you want to query to an image in <code class="language-plaintext highlighter-rouge">/src/images/example.png</code>, you can use,</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">query</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`
  query {
    file(absolutePath: {
      regex: "/\\/src\\/images\\/example\\.png/"
    }) {
      childImageSharp {
        fixed(width: 800) {
          ...GatsbyImageSharpFixed
        }
      }
    }
  }
`</span>
</code></pre></div></div>

<h3 id="svg-files">SVG files</h3>

<p><code class="language-plaintext highlighter-rouge">gatsby-plugin-sharp</code> / <code class="language-plaintext highlighter-rouge">gatsby-image</code> doesn‚Äôt handle SVGs or GIFs. If you want to use your svg you, e.g. could import / use it like <code class="language-plaintext highlighter-rouge">import yourSVG from './logo_large.svg'</code>.<sup><a href="https://github.com/gatsbyjs/gatsby/issues/10297 " target="_blank">[ref]</a></sup></p>

<h2 id="change-favicon">Change favicon</h2>

<p>Put <code class="language-plaintext highlighter-rouge">favicon.png</code> in <code class="language-plaintext highlighter-rouge">src/images</code> and then change <code class="language-plaintext highlighter-rouge">gatsby-config.js</code></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="nl">resolve</span><span class="p">:</span> <span class="s2">`gatsby-plugin-manifest`</span><span class="p">,</span>
  <span class="nx">options</span><span class="p">:</span> <span class="p">{</span>
    <span class="c1">// other stuffs</span>
    <span class="nl">icon</span><span class="p">:</span> <span class="s2">`src/images/favicon.png`</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">},</span>
</code></pre></div></div>

<p>You need to restart <code class="language-plaintext highlighter-rouge">gastby</code> to see the result!</p>

<h2 id="multiple-images-from-data-filefolder">Multiple images from data file/folder</h2>

<h3 id="images-urls-stored-in-a-json-file">Images‚Äô URLs stored in a JSON file</h3>

<p>Suppose that we store some images in <code class="language-plaintext highlighter-rouge">/src/images/</code> and we indicate them in a json file like this,</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">//</span><span class="w"> </span><span class="err">File</span><span class="w"> </span><span class="err">/data/AccountItem.json</span><span class="w">
</span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Github"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./github.svg"</span><span class="p">,</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"LinkedIn"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./linkedin.svg"</span><span class="p">,</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Math2IT"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"./math2it.png"</span><span class="p">,</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<p>Images (<code class="language-plaintext highlighter-rouge">github.svg</code>, <code class="language-plaintext highlighter-rouge">linkedin.svg</code>, <code class="language-plaintext highlighter-rouge">math2it.png</code>) are stored in the same folder of your json file, that why we put <code class="language-plaintext highlighter-rouge">./</code> before them!</p>

<p>‚ùì There are both <code class="language-plaintext highlighter-rouge">png</code> and <code class="language-plaintext highlighter-rouge">svg</code> files in the list. We cannot use <code class="language-plaintext highlighter-rouge">childImageSharp</code> for svg files. How can we ‚Äúloop‚Äù through each item and consider differently svg and png files?</p>

<p>üí° Read <a href="https://itnext.io/reading-data-from-a-json-file-with-gatsby-graphql-572b18ab98a">this tutorial</a> to read data from a json file.</p>

<p>1/ Having a json file, in this example, it‚Äôs <code class="language-plaintext highlighter-rouge">/data/AccountItem.json</code> (you can name it whatwever you want but its name is really important for using later!!!)</p>

<p>2/ Install</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install </span>gatsby-transformer-json gatsby-source-filesystem <span class="nt">--save</span>
</code></pre></div></div>

<p>3/ Inside <code class="language-plaintext highlighter-rouge">/gatsby-config.js</code>, add following (direction in <code class="language-plaintext highlighter-rouge">path</code> is the direction to the folder containing your json file),</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">`gatsby-transformer-json`</span><span class="p">,</span>
<span class="p">{</span>
  <span class="na">resolve</span><span class="p">:</span> <span class="dl">'</span><span class="s1">gatsby-source-filesystem</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">data</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">path</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">__dirname</span><span class="p">}</span><span class="s2">/data/`</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">}</span>
</code></pre></div></div>

<p>4/ Suppose that we wanna load images in a component <code class="language-plaintext highlighter-rouge">/src/components/ListAccount.js</code>. Put in it,<sup><a href="https://github.com/gatsbyjs/gatsby/issues/10297#issuecomment-464834529 " target="_blank">[ref]</a></sup></p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">StaticQuery</span><span class="p">,</span> <span class="nx">graphql</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">gatsby</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Img</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">gatsby-image</span><span class="dl">'</span>

<span class="kd">const</span> <span class="nx">ListAccount</span> <span class="o">=</span> <span class="p">(</span> <span class="p">{</span><span class="nx">accounts</span><span class="p">}</span> <span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="si">{</span><span class="nx">accounts</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">account</span> <span class="o">=&gt;</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="p">=</span><span class="s">"item"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="p">=</span><span class="s">"img"</span><span class="p">&gt;</span>
          <span class="si">{</span><span class="o">!</span><span class="nx">account</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">icon</span><span class="p">.</span><span class="nx">childImageSharp</span>
            <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">account</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">icon</span><span class="p">.</span><span class="nx">extension</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">svg</span><span class="dl">'</span><span class="p">)</span>
            <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="p">=</span><span class="si">{</span><span class="nx">account</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">icon</span><span class="p">.</span><span class="nx">publicURL</span><span class="si">}</span> <span class="p">/&gt;</span>
            <span class="si">}</span>
          <span class="si">{</span><span class="nx">account</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">icon</span><span class="p">.</span><span class="nx">extension</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">svg</span><span class="dl">'</span>
            <span class="o">&amp;&amp;</span> <span class="p">&lt;</span><span class="nc">Img</span> <span class="na">fixed</span><span class="p">=</span><span class="si">{</span><span class="nx">account</span><span class="p">.</span><span class="nx">node</span><span class="p">.</span><span class="nx">icon</span><span class="p">.</span><span class="nx">childImageSharp</span><span class="p">.</span><span class="nx">fixed</span><span class="si">}</span> <span class="p">/&gt;</span>
            <span class="si">}</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">))</span><span class="si">}</span>
  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">)</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">props</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nc">StaticQuery</span>
    <span class="na">query</span><span class="p">=</span><span class="si">{</span><span class="nx">graphql</span><span class="s2">`
      query AccountItemsQuery {
        allAccountItemsJson{
          edges{
            node{
              name
              icon{
                childImageSharp {
                  fixed(width: 150, height: 150) {
                    ...GatsbyImageSharpFixed_tracedSVG
                  }
                }
                extension
                publicURL
              }
            }
          }
        }
      }
    `</span><span class="si">}</span>
    <span class="na">render</span><span class="p">=</span><span class="si">{</span><span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">&lt;</span><span class="nc">ListAccount</span> <span class="na">accounts</span><span class="p">=</span><span class="si">{</span><span class="nx">data</span><span class="p">.</span><span class="nx">allAccountItemsJson</span><span class="p">.</span><span class="nx">edges</span><span class="si">}</span> <span class="si">{</span><span class="p">...</span><span class="nx">props</span><span class="si">}</span> <span class="p">/&gt;</span><span class="si">}</span>
  <span class="p">/&gt;</span>
<span class="p">)</span>
</code></pre></div></div>

<p>Explaination:</p>

<ul>
  <li>We have to put <code class="language-plaintext highlighter-rouge">extension</code> and <code class="language-plaintext highlighter-rouge">publicURL</code> inside <code class="language-plaintext highlighter-rouge">icon</code> because there are <code class="language-plaintext highlighter-rouge">svg</code> files!</li>
  <li>For more intuition, look at <a href="http://localhost:8000/___graphql">http://localhost:8000/___graphql</a>.</li>
  <li>In <code class="language-plaintext highlighter-rouge">edges</code>, there are many <code class="language-plaintext highlighter-rouge">node</code>s, each of them is relating to the item inside <code class="language-plaintext highlighter-rouge">AccountItem.json</code>. That‚Äôs why the input data for <code class="language-plaintext highlighter-rouge">&lt;ListAccount /&gt;</code> must be <code class="language-plaintext highlighter-rouge">data.allAccountItemsJson.edges</code>.</li>
  <li>For each <code class="language-plaintext highlighter-rouge">account</code> in <code class="language-plaintext highlighter-rouge">accounts</code>, we have to pass <code class="language-plaintext highlighter-rouge">account.node</code> before each attribute <code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">icon</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">{condition &amp;&amp; condition &amp;&amp; output}</code> is a trick for not using <code class="language-plaintext highlighter-rouge">if...else</code>.</li>
</ul>

<p>üëâ In the case you store images in a different folder, let‚Äôs say <code class="language-plaintext highlighter-rouge">/src/images/accounts/</code>, you have to indicate it in <code class="language-plaintext highlighter-rouge">/data/AccountItems.json</code>:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"icon"</span><span class="p">:</span><span class="w"> </span><span class="s2">"../src/images/accounts/github.svg"</span><span class="p">,</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>

<h3 id="using-yaml-data-file">Using YAML data file</h3>

<p>Suppose our <code class="language-plaintext highlighter-rouge">yaml</code> file,</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">// File /data/AccountItem.yaml</span>

<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Github</span>
  <span class="na">icon</span><span class="pi">:</span> <span class="s">./github.svg</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">LinkedIn</span>
  <span class="na">icon</span><span class="pi">:</span> <span class="s">./linkedin.svg</span>
<span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Math2IT</span>
  <span class="na">icon</span><span class="pi">:</span> <span class="s">./math2it.png</span>
</code></pre></div></div>

<p>The same technique as in the case of <code class="language-plaintext highlighter-rouge">json</code> file. In this case, we need to install <a href="https://www.gatsbyjs.org/packages/gatsby-transformer-yaml/"><code class="language-plaintext highlighter-rouge">gatsby-transformer-yaml</code></a>,</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm <span class="nb">install</span> <span class="nt">--save</span> gatsby-transformer-yaml
</code></pre></div></div>

<p>In your <code class="language-plaintext highlighter-rouge">gatsby-config.js</code>,</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">`gatsby-transformer-yaml`</span><span class="p">,</span>
<span class="p">{</span>
  <span class="na">resolve</span><span class="p">:</span> <span class="s2">`gatsby-source-filesystem`</span><span class="p">,</span>
  <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">data</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">path</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">__dirname</span><span class="p">}</span><span class="s2">/data/`</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">},</span>
</code></pre></div></div>

<h2 id="query-as-an-input"><code class="language-plaintext highlighter-rouge">query</code> as an input</h2>

<p>In the previous step, <code class="language-plaintext highlighter-rouge">query</code> is considered inside the component file. What if you wanna query data and then pass it in a JSX components? (check <code class="language-plaintext highlighter-rouge">index.js</code> for an example)</p>

<p>There is a data file <code class="language-plaintext highlighter-rouge">/data/MostProudOfItems.yaml</code>.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// in /src/pages/index.js</span>

<span class="k">import</span> <span class="nx">ShortcutListing</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../components/ShortcutListing</span><span class="dl">"</span>

<span class="kd">const</span> <span class="nx">indexPage</span> <span class="o">=</span> <span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="p">&lt;</span><span class="nc">ShortcutListing</span>
    <span class="na">shortcuts</span><span class="p">=</span><span class="si">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">allMostProudOfItemsYaml</span><span class="p">.</span><span class="nx">edges</span><span class="si">}</span>
    <span class="na">nShortcutsPerRow</span><span class="p">=</span><span class="s">'3'</span> <span class="p">/&gt;</span>
<span class="p">)</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">IndexPage</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">pageQuery</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`
  query IndexQuery {
    allMostProudOfItemsYaml{
      edges {
        node {
          title
          img {
            childImageSharp {
              fixed(width: 100, height: 100) {
                ...GatsbyImageSharpFixed_tracedSVG
              }
            }
            extension
            publicURL
          }
          url
        }
      }
    },
    anotherYaml{
      ....
    }
  }
`</span>
</code></pre></div></div>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// in /src/components/ShortcutListing</span>

<span class="kd">const</span> <span class="nx">ListShortcut</span> <span class="o">=</span> <span class="p">({</span><span class="nx">shortcuts</span><span class="p">,</span> <span class="nx">nShortcutsPerRow</span><span class="p">})</span> <span class="o">=&gt;</span> <span class="p">(</span>
  <span class="c1">// ...</span>
<span class="p">)</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">ListShortcut</span>
</code></pre></div></div>

<h2 id="get-all-images-from-a-specific-folder">Get all images from a specific folder</h2>

<p>üëâ This is also a way you use the <code class="language-plaintext highlighter-rouge">name</code> indicate in <code class="language-plaintext highlighter-rouge">gatsby-config.js</code>.</p>

<p><sup><a href="https://stackoverflow.com/questions/57515558/how-should-i-import-all-the-images-under-a-folder-in-gatsby " target="_blank">[ref]</a></sup>
Suppose that you wanna show all images in <code class="language-plaintext highlighter-rouge">/sketches/</code>.</p>

<div class="d-md-flex">
  <div class="language-js flex-even overflow-auto pr-md-1 highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// In /gatsby-config.js</span>
<span class="p">{</span>
  <span class="nl">resolve</span><span class="p">:</span> <span class="dl">"</span><span class="s2">gatsby-source-filesystem</span><span class="dl">"</span><span class="p">,</span>
  <span class="nx">options</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">path</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">__dirname</span><span class="p">}</span><span class="s2">/sketches/`</span><span class="p">,</span>
    <span class="nx">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">sketchFolder</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">},</span>
</code></pre></div>  </div>

  <div class="language-js flex-even overflow-auto pl-md-1 highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">pageQuery</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`
  query IndexQuery {
    allFile(filter: {
      extension: {regex: "/(jpg)|(jpeg)|(png)/"},
      sourceInstanceName: {eq: "sketchFolder"}})
    {
      edges {
        node {
          childImageSharp {
            fluid {
              originalName
            }
          }
          absolutePath
        }
      }
    }
  }
`</span>
</code></pre></div>  </div>
</div>

<p>üí¢ Above method is <strong>only works</strong> with <code class="language-plaintext highlighter-rouge">/sketches</code> (folder locates at the root of site). It doesn‚Äôt work with <code class="language-plaintext highlighter-rouge">/src/images/sketches</code>, for example. I don‚Äôt know why!</p>

<p>üëâ If you want to get all images from a folder (without using <code class="language-plaintext highlighter-rouge">sourceInstanceName</code>) you can use <code class="language-plaintext highlighter-rouge">relativeDirectory</code> in the <code class="language-plaintext highlighter-rouge">query</code>. Suppose that we have 2 folders with the same name <code class="language-plaintext highlighter-rouge">sketches</code>, one is in <code class="language-plaintext highlighter-rouge">/content/sketches</code>, one is in <code class="language-plaintext highlighter-rouge">/src/images/sketches</code>. The following code will <strong>load all images in these two folders</strong>!</p>

<div class="d-md-flex">
  <div class="language-js flex-even overflow-auto pr-md-1 highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// In /gatsby-config.js</span>
<span class="p">{</span>
  <span class="nl">resolve</span><span class="p">:</span> <span class="dl">"</span><span class="s2">gatsby-source-filesystem</span><span class="dl">"</span><span class="p">,</span>
  <span class="nx">options</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">path</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">__dirname</span><span class="p">}</span><span class="s2">/content/`</span><span class="p">,</span>
    <span class="nx">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">content</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">},</span>
<span class="p">{</span>
  <span class="na">resolve</span><span class="p">:</span> <span class="dl">"</span><span class="s2">gatsby-source-filesystem</span><span class="dl">"</span><span class="p">,</span>
  <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">__dirname</span><span class="p">}</span><span class="s2">/src/images`</span><span class="p">,</span>
    <span class="na">name</span><span class="p">:</span> <span class="dl">"</span><span class="s2">images</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">},</span>
</code></pre></div>  </div>

  <div class="language-js flex-even overflow-auto pl-md-1 highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">const</span> <span class="nx">pageQuery</span> <span class="o">=</span> <span class="nx">graphql</span><span class="s2">`
  query IndexQuery {
    allFile(filter: {
      extension: {regex: "/(jpg)|(jpeg)|(png)/"},
      relativeDirectory: {eq: "sketches"}})
    {
      edges {
        node {
          childImageSharp {
            fluid {
              originalName
            }
          }
          absolutePath
        }
      }
    }
  }
`</span>
</code></pre></div>  </div>
</div>

<p>üí¢ Make sure the name of your folder is <strong>unique</strong> if you don‚Äôt want to load images from a wrong location.</p>

<h2 id="references">References</h2>

<ul>
  <li><a href="https://www.orangejellyfish.com/blog/a-comprehensive-guide-to-images-in-gatsby/">A comprehensive guide to images in Gatsby</a> by James Allardice.</li>
  <li><a href="https://image-processing.gatsbyjs.org/">Image Processing with <code class="language-plaintext highlighter-rouge">gatsby-transformer-sharp</code></a>.</li>
  <li><a href="https://416serg.me/building-a-custom-accessible-image-lightbox-in-gatsbyjs/">Building A Custom, Accessible Image Lightbox In GatsbyJS</a></li>
</ul>


<!-- <div class="box-error">
<h4>Notice an error?</h4>
Everything on this site is <a href="https://github.com/baotrung217/dinhanhthi.com" target="_blank">published</a> on Github. If you find something wrong, <a href="https://github.com/dinhanhthi/dinhanhthi.com/edit/master/_posts/web-dev/2019-12-31-gatsby-images.md" target="_blank">just edit it</a> or <a href="mailto:baotrung217@gmail.com?subject=Suggest to edit post 'Gatsby Images'">tell me</a> about it.
</div> -->

<div class="sec-comment">

  

  <button class="btn btn-info w-100" id="show-comments" onclick="load_comment();return false;">
    If you find something wrong or need a comment, click here.
  </button>

  <div id='comment-box' style="display: none;">
    <script src="https://utteranc.es/client.js"
            repo="dinhanhthi/dinhanhthi.com"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
  </div>

  <script>
    var comment_loaded = false;
    function load_comment() {
        if (!comment_loaded)  {
            comment_loaded = true;
            document.getElementById("show-comments").style.display = "none";
            document.getElementById("comment-box").style.display = "block";
        }
    }
  </script>
</div>

<div class="modal fade" id="imagemodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg modal-xl">
    <div class="modal-content">
      <div class="modal-body">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <img src="" class="imagepreview" style="width: 100%;" >
      </div>
    </div>
  </div>
</div>



          </article >
        </div>
      </div>
    </div>
  </section>
</main>



  <footer class="footer">
    <div class="container">
  <div class="row justify-content-center">
    <div class="col-12 col-md-8 col-lg-6 text-center p-3">
      <div class="footer-info">
        <a href="https://baotrung.dev" target="_blank">Trung</a>
        &nbsp;&copy;&nbsp;
        2022
        &nbsp;&bull;&nbsp;
        <a href="http://localhost:4000/about-the-notes">
          About the notes
        </a>
        &nbsp;&bull;&nbsp;
        <a href="https://pobo.dinhanhthi.com" target="_blank">
          Po Bo
        </a>
        &nbsp;&bull;&nbsp;
        <a href="/for-me-only">
          For me only
        </a>
        &nbsp;&bull;&nbsp;
        <a class="donate" href="http://localhost:4000/donate">
          Support Trung
        </a>
      </div>
    </div>
  </div>
</div>

  </footer>

  





  

  <script src="https://code.jquery.com/jquery-1.10.1.min.js" integrity="sha256-SDf34fFWX/ZnUozXXEH0AeB+Ip3hvRsjLwp6QNTEb3k=" crossorigin="anonymous" async></script>

  <!-- scrolling-toc -->
  <script src="http://localhost:4000/js/scrolling-toc.js" type="text/javascript" async></script>

  <!-- bootstrap -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous" async></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous" async></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous" async></script>

  <script src="http://localhost:4000/js/click_to_zoom.js" async></script>

  <script src="http://localhost:4000/js/anchor.js" async></script>

</body>
</html>
