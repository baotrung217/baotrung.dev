<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

	<!-- block search indexing -->
	<meta name="robots" content="noindex">
	<meta name="googlebot" content="noindex">

  <!-- bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous" async>

  <!-- fontawesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" async>

  <!-- google fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin async >
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&display=swap" rel="stylesheet" crossorigin async>
  <link href="https://fonts.googleapis.com/css?family=Livvic:400,400i,500,500i,600&display=swap&subset=vietnamese" rel="stylesheet" crossorigin async>
  <link href="https://fonts.googleapis.com/css?family=Lobster&display=swap" rel="stylesheet" crossorigin async>

  <link rel="alternate" hreflang="en" href="/deeplearning-ai-tensorflow-course-1" async />

  <link rel="shortcut icon" type="image/x-icon" href="/img/avatar-icon.ico" async>
  <meta name="author" content="Anh-Thi Dinh" />

  <title>
    
      Thi | TF 1 - Intro to TensorFlow for AI, ML, DL
    
  </title>

  

  <!-- feed -->
  <link rel="alternate" type="application/rss+xml" title="Anh-Thi Dinh - I failed my way to success" href="/feed.xml" async />

  <!-- page (internal) -->
  

  <!-- layout (internal) -->
  
    
      <link rel="stylesheet" href="/css/main.css" async />
    
      <link rel="stylesheet" href="/css/rouge-thi.css" async />
    
  
  

    <!-- Facebook OpenGraph tags -->
  
    <meta property="fb:app_id" content="1150663561751902" />
  

  
    <meta property="fb:admins" content="mrdinhanhthi"/>
  

  
    <meta property="og:title" content="TF 1 - Intro to TensorFlow for AI, ML, DL" />
  

  
    <meta property="og:description" content="Basic DL on MNIST Basic DL on Fashion-MNIST Basic CNN on Fashion-MNIST Visualizing the Convolutions and Pooling Using real-world images ImageGenerator ConvNet with ImageGenerator This is my note for the first course of TensorFlow in Practice Specialization given by deeplearning.ai and taught by Laurence Moroney on Coursera. ðŸ‘‰ Check the...">
  


  <meta property="og:type" content="website" />

  
    <meta property="og:url" content="http://localhost:4000/deeplearning-ai-tensorflow-course-1" />
    <link rel="canonical" href="http://localhost:4000/deeplearning-ai-tensorflow-course-1" async />
  

  <meta property="og:image" content="http://localhost:4000/img/background.png" />
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="1234">
  <meta property="og:image:height" content="592">

  

  

  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous" async >
  <script>
    $("script[type='math/tex']").replaceWith(function() {
        var tex = $(this).text();
        return katex.renderToString(tex, {displayMode: false});
    });

    $("script[type='math/tex; mode=display']").replaceWith(function() {
        var tex = $(this).html();
        return katex.renderToString(tex.replace(/%.*/g, ''), {displayMode: true});
    });
  </script>
  

  

</head>


<body>
  <script>
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '1150663561751902',
      xfbml      : true,
      version    : 'v3.1'
    });
  
    FB.AppEvents.logPageView();
  
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "https://connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
</script>
  <header>
    <nav class="navbar navbar-dark nav-bg navbar-custom fixed-top">
  <div class="container">
    <div class="col-12 col-lg-10 offset-lg-1">
      <div class="nav-container">
        <a class="nav-item" href="http://localhost:4000/">
          <i style="color: #ffeead;" class="fas fa-home" aria-hidden="true"></i>
          <span>Home</span>
        </a>
        <a class="nav-item" href="http://localhost:4000/about">
          <i style="color: #e97c8e;" class="fas fa-fire" aria-hidden="true"></i>
          <span>Me</span>
        </a>
        <a class="nav-item" href="http://localhost:4000/notes">
          <i style="color: #93ceff;" class="fas fa-edit" aria-hidden="true"></i>
          <span>Notes</span>
        </a>
        <div class="nav-search">
          <form action="http://localhost:4000/search" method="get">
            <button class="nav-search-submit" type="submit">
              <i class="fa fa-search" aria-hidden="true"></i>
            </button>
            <input name="q" class="nav-search-input" type="search" placeholder="search notes..." aria-label="search notes...">
          </form>
        </div>
        <a class="nav-item nav-github" href="https://github.com/dinhanhthi" target="_blank">
          <i class="fab fa-github"></i>
        </a>
    </div>
    </div>
  </div>
</nav>

  </header>

  
  <header class="header">
    <div class="container">
      <div class="row align-items-center justify-content-center">
        <div class="col-md-8 header-content">
          
          
            <div class="icon-photo">
              <img src="http://localhost:4000/img/header/tensorflow.svg">
            </div>
          
          <h1 class="post-title">
            TF 1 - Intro to TensorFlow for AI, ML, DL
          </h1>
          
            <div class="tag-in-post">
              
              
                
                
                
                
                
                  <a href="/tags#coursera">
                    coursera
                  </a>
                

              
                
                
                
                
                
                  <a href="/tags#deeplearning-ai">
                    deeplearning.ai
                  </a>
                

              
                
                
                
                
                
                  <a href="/tags#mooc">
                    mooc
                  </a>
                

              
                
                
                
                
                
                  <a href="/tags#tensorflow">
                    tensorflow
                  </a>
                

              
            </div>
          
          <p>
            
              26 Jul 2020
                        
          </p>
        </div>
      </div>
    </div>
  </header>


<main role="main">
  <section class="section">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-12 col-lg-10 col-xl-9">
          <article  class="page-content ">
            <p style="font-style: italic; color: #777; font-size: 0.95rem; margin-bottom: 2rem;">
  Last modified on 01 Oct 2021.
</p>




<div id="toc">
  <div class="toc-content">
<ul id="markdown-toc">
  <li><a href="#basic-dl-on-mnist" id="markdown-toc-basic-dl-on-mnist">Basic DL on MNIST</a></li>
  <li><a href="#basic-dl-on-fashion-mnist" id="markdown-toc-basic-dl-on-fashion-mnist">Basic DL on Fashion-MNIST</a></li>
  <li><a href="#basic-cnn-on-fashion-mnist" id="markdown-toc-basic-cnn-on-fashion-mnist">Basic CNN on Fashion-MNIST</a></li>
  <li><a href="#visualizing-the-convolutions-and-pooling" id="markdown-toc-visualizing-the-convolutions-and-pooling">Visualizing the Convolutions and Pooling</a></li>
  <li><a href="#using-real-world-images" id="markdown-toc-using-real-world-images">Using real-world images</a>    <ul>
      <li><a href="#imagegenerator" id="markdown-toc-imagegenerator">ImageGenerator</a></li>
      <li><a href="#convnet-with-imagegenerator" id="markdown-toc-convnet-with-imagegenerator">ConvNet with ImageGenerator</a></li>
    </ul>
  </li>
</ul>

  </div>
</div>

<p>This is my note for the <a href="https://www.coursera.org/learn/introduction-tensorflow">first course</a> of <a href="https://www.coursera.org/specializations/tensorflow-in-practice">TensorFlow in Practice Specialization</a> given by <a href="http://deeplearning.ai/">deeplearning.ai</a> and taught by Laurence Moroney on Coursera.</p>

<p>ðŸ‘‰ Check the codes <a href="https://github.com/dinhanhthi/deeplearning.ai-courses/tree/master/TensorFlow%20in%20Practice">on my Github</a>.<br />
ðŸ‘‰ Official <a href="https://github.com/lmoroney/dlaicourse">notebooks</a> on Github.</p>

<p>ðŸ‘‰ Go to <a href="/deeplearning-ai-tensorflow-course-2">course 2 - CNN in Tensorflow</a>.<br />
ðŸ‘‰ Go to <a href="/deeplearning-ai-tensorflow-course-3">course 3 - NLP in Tensorflow</a>.<br />
ðŸ‘‰ Go to <a href="/deeplearning-ai-tensorflow-course-4">course 4 - Sequences, Time Series and Prediction</a>.</p>

<h2 id="basic-dl-on-mnist">Basic DL on MNIST</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>

<span class="c1"># stop the training with condition
</span><span class="k">class</span> <span class="nc">myCallback</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">callbacks</span><span class="p">.</span><span class="n">Callback</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">logs</span><span class="o">=</span><span class="p">{}):</span> <span class="c1"># compare at the end of each epoch
</span>        <span class="k">if</span><span class="p">(</span><span class="n">logs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'accuracy'</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.99</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">stop_training</span> <span class="o">=</span> <span class="bp">True</span>

<span class="n">mnist</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">datasets</span><span class="p">.</span><span class="n">mnist</span>
<span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="p">.</span><span class="n">load_data</span><span class="p">()</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span> <span class="o">=</span> <span class="n">x_train</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">x_test</span> <span class="o">/</span> <span class="mf">255.0</span> <span class="c1"># normalize
</span>
<span class="n">callbacks</span> <span class="o">=</span> <span class="n">myCallback</span><span class="p">()</span> <span class="c1"># define the callback
</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">models</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span> <span class="c1"># Takes that square and
</span>                                                   <span class="c1"># turns it into a 1 dim
</span>    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="n">relu</span><span class="p">),</span>
    <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="n">softmax</span><span class="p">)</span> <span class="c1"># 10 outputs
</span><span class="p">])</span>

<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="s">'sparse_categorical_crossentropy'</span><span class="p">,</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>

<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">callbacks</span><span class="p">])</span>
</code></pre></div></div>

<p><strong>Comments</strong> (<a href="https://bit.ly/3jHSCYg">notebook</a>):</p>

<ol>
  <li>Adding more Neurons we have to do more calculations, slowing down the process, but get more accurate.</li>
  <li>The first layer in your network should be the same shape as your data.</li>
  <li>The number of neurons in the last layer should match the number of classes you are classifying for.</li>
  <li>Extra layers are often necessary.</li>
  <li><strong>Flatten</strong> as the name implies, converts your multidimensional matrices (<code class="language-plaintext highlighter-rouge">Batch.Size x Img.W x Img.H x Kernel.Size</code>) to a nice single 2-dimensional matrix: (<code class="language-plaintext highlighter-rouge">Batch.Size x (Img.W x Img.H x Kernel.Size)</code>). During backpropagation it also converts back your delta of size (<code class="language-plaintext highlighter-rouge">Batch.Size x (Img.W x Img.H x Kernel.Size)</code>) to the original (<code class="language-plaintext highlighter-rouge">Batch.Size x Img.W x Img.H x Kernel.Size</code>).</li>
  <li><strong>Dense layer</strong> is of course the standard fully connected layer.</li>
</ol>

<p class="img-100 pop"><img src="/img/post/mooc/tf/cnn-layers.png" alt="CNN layers" />
<em>CNN layers, <a href="mdpi.com">cource of image</a>.</em></p>

<h2 id="basic-dl-on-fashion-mnist">Basic DL on Fashion-MNIST</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># the same as in MINST
# different at below line of loading data
</span><span class="n">mnist</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">datasets</span><span class="p">.</span><span class="n">fashion_mnist</span>
</code></pre></div></div>

<h2 id="basic-cnn-on-fashion-mnist">Basic CNN on Fashion-MNIST</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="n">mnist</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">datasets</span><span class="p">.</span><span class="n">fashion_mnist</span>

<span class="k">class</span> <span class="nc">myCallback</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">callbacks</span><span class="p">.</span><span class="n">Callback</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">on_epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">logs</span><span class="o">=</span><span class="p">{})</span> <span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">logs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'accuracy'</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">logs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'accuracy'</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mf">0.998</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">Reached 99.8% accuracy so cancelling training!'</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">model</span><span class="p">.</span><span class="n">stop_training</span> <span class="o">=</span> <span class="bp">True</span>

<span class="p">(</span><span class="n">training_images</span><span class="p">,</span> <span class="n">training_labels</span><span class="p">),</span> <span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="p">.</span><span class="n">load_data</span><span class="p">()</span>
<span class="c1"># Why reshape?
# The first convolution expects a single tensor containing everything,
# so instead of 60000 28x28x1 items in a list, we have a single 4D list
# that is 60000x28x28x1
#
# training_images' shape (before reshape): (60000, 28, 28)
# training_images' shape (after reshape): (60000, 28, 28, 1)
# trainaing_labels' shape: (60000,)
</span><span class="n">training_images</span><span class="o">=</span><span class="n">training_images</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">60000</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">training_images</span><span class="o">=</span><span class="n">training_images</span> <span class="o">/</span> <span class="mf">255.0</span>
<span class="n">test_images</span> <span class="o">=</span> <span class="n">test_images</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">test_images</span><span class="o">=</span><span class="n">test_images</span><span class="o">/</span><span class="mf">255.0</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">models</span><span class="p">.</span><span class="n">Sequential</span><span class="p">([</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Conv2D</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Flatten</span><span class="p">(),</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">),</span>
  <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'softmax'</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="s">'sparse_categorical_crossentropy'</span><span class="p">,</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>

<span class="n">callbacks</span> <span class="o">=</span> <span class="n">myCallback</span><span class="p">()</span>

<span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">training_images</span><span class="p">,</span> <span class="n">training_labels</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">callbacks</span><span class="p">])</span>
<span class="n">test_loss</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">test_images</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>model.summary<span class="o">()</span> <span class="c"># model detail</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Model: <span class="s2">"sequential_1"</span>
_________________________________________________________________
Layer <span class="o">(</span><span class="nb">type</span><span class="o">)</span>                 Output Shape              Param <span class="c">#</span>
<span class="o">=================================================================</span>
conv2d <span class="o">(</span>Conv2D<span class="o">)</span>              <span class="o">(</span>None, 26, 26, 64<span class="o">)</span>        640
                             <span class="c"># for every image, 64 convolution has been tried</span>
                             <span class="c"># 26 (=28-2) because we use 3x3 filter and we can't</span>
                             <span class="c"># count on edges, so the picture is 2 smaller on x and y.</span>
                             <span class="c"># if 5x5 filter =&gt; 4 smaller on x and y.</span>
_________________________________________________________________
max_pooling2d <span class="o">(</span>MaxPooling2D<span class="o">)</span> <span class="o">(</span>None, 13, 13, 64<span class="o">)</span>        0
_________________________________________________________________
conv2d_1 <span class="o">(</span>Conv2D<span class="o">)</span>            <span class="o">(</span>None, 11, 11, 64<span class="o">)</span>        36928
_________________________________________________________________
max_pooling2d_1 <span class="o">(</span>MaxPooling2 <span class="o">(</span>None, 5, 5, 64<span class="o">)</span>          0
_________________________________________________________________
flatten_1 <span class="o">(</span>Flatten<span class="o">)</span>          <span class="o">(</span>None, 1600<span class="o">)</span>              0
_________________________________________________________________
dense_2 <span class="o">(</span>Dense<span class="o">)</span>              <span class="o">(</span>None, 128<span class="o">)</span>               204928
_________________________________________________________________
dense_3 <span class="o">(</span>Dense<span class="o">)</span>              <span class="o">(</span>None, 10<span class="o">)</span>                1290
<span class="o">=================================================================</span>
Total params: 243,786
Trainable params: 243,786
Non-trainable params: 0
</code></pre></div></div>

<p>Refs:</p>

<ol>
  <li><a href="https://en.wikipedia.org/wiki/Kernel_(image_processing)">Kernel in image processing</a>: examples with images.</li>
  <li><a href="https://en.wikipedia.org/wiki/Convolutional_neural_network#Pooling_layer">Pooling layer</a>: non-linear down-sampling.</li>
</ol>

<p>More?</p>

<ol>
  <li><a href="https://lodev.org/cgtutor/filtering.html">Image Filtering</a> â€“ Lodeâ€™s Computer Graphics Tutorial</li>
  <li>Applying Convolutions on top of our Deep neural network will make training =&gt; It depends on many factors. It might make your training faster or slower, and a poorly designed Convolutional layer may even be less efficient than a plain DNN!</li>
  <li><strong>What is a Convolution?</strong> =&gt; A technique to isolate features in images</li>
  <li><strong>What is a Pooling?</strong> =&gt; A technique to reduce the information in an image while maintaining features</li>
  <li>How do Convolutions improve image recognition? =&gt; They isolate features in images</li>
  <li>
    <p>After passing a 3x3 conv filter over a 28x28 image, how big will the output be? =&gt; 26x26</p>

    <p class="img-30"><img src="/img/post/mooc/tf/conv_ker_3x3.gif" alt="3x3 conv kernel" />
 <em>7x7 to 5x5 (<a href="https://iamaaditya.github.io/2016/03/one-by-one-convolution/">source</a>)</em></p>
  </li>
  <li>
    <p>After max pooling a 26x26 image with a 2x2 filter, how big will the output be? =&gt; 13x13</p>

    <p class="img-40"><img src="/img/post/mooc/tf/max-pooling.jpg" alt="max pooling idea" />
 <em>(<a href="https://deepai.org/machine-learning-glossary-and-terms/max-pooling">source</a>)</em></p>
  </li>
</ol>

<h2 id="visualizing-the-convolutions-and-pooling">Visualizing the Convolutions and Pooling</h2>

<p>Using layer API, something like below, check more in <a href="https://bit.ly/3f6wQtA">the notebook</a>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">f</span><span class="p">,</span> <span class="n">axarr</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">models</span>
<span class="n">layer_outputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">layer</span><span class="p">.</span><span class="n">output</span> <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">model</span><span class="p">.</span><span class="n">layers</span><span class="p">]</span>
<span class="n">activation_model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">models</span><span class="p">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nb">input</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">layer_outputs</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">activation_model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_images</span><span class="p">[</span><span class="n">FIRST_IMAGE</span><span class="p">].</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">))[</span><span class="n">x</span><span class="p">]</span>
    <span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">].</span><span class="n">imshow</span><span class="p">(</span><span class="n">f1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span> <span class="p">,</span> <span class="p">:,</span> <span class="n">CONVOLUTION_NUMBER</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s">'inferno'</span><span class="p">)</span>
    <span class="n">axarr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">].</span><span class="n">grid</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="p">...</span>
</code></pre></div></div>

<h2 id="using-real-world-images">Using real-world images</h2>

<p>An example of classifying horses and humans!</p>

<h3 id="imagegenerator">ImageGenerator</h3>

<p>ðŸ‘‰ <a href="https://www.coursera.org/lecture/introduction-tensorflow/understanding-imagegenerator-kqRHk">Video explain ImageGenerator</a>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># make images more used for training
# (focus on object, split cleary objects, label images,...)
# also help to augmenting data (rotate, skew, flip,...)
</span><span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing.image</span> <span class="kn">import</span> <span class="n">ImageDataGenerator</span>

<span class="n">train_datagen</span> <span class="o">=</span> <span class="n">ImageDataGenerator</span><span class="p">(</span><span class="n">rescale</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span>
    <span class="c1"># normalize -&gt; No need to convert images and then put in the training
</span>    <span class="c1"># do the scaling on the fly
</span><span class="n">train_generator</span> <span class="o">=</span> <span class="n">train_datagen</span><span class="p">.</span><span class="n">flow_from_directory</span><span class="p">(</span>
    <span class="n">train_dir</span><span class="p">,</span> <span class="c1"># dir contains the dir containing your images
</span>               <span class="c1"># -&gt; be careful!
</span>    <span class="n">target_size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="c1"># images will be resized when loaded, genial!
</span>                            <span class="c1"># because NN always needs that!
</span>                            <span class="c1"># -&gt; experimenting with diff sizes without
</span>                            <span class="c1"># impacting your source data
</span>    <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>
    <span class="n">class_mode</span><span class="o">=</span><span class="s">"binary"</span>     <span class="c1"># 2 diff things
</span><span class="p">)</span>

<span class="n">test_datagen</span> <span class="o">=</span> <span class="n">ImageDataGenerator</span><span class="p">(</span><span class="n">rescale</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="mi">255</span><span class="p">)</span> <span class="c1"># normalize
</span><span class="n">validation_generator</span> <span class="o">=</span> <span class="n">test_datagen</span><span class="p">.</span><span class="n">flow_from_directory</span><span class="p">(</span>
    <span class="n">validation_dir</span><span class="p">,</span> <span class="c1"># dir contains the dir containing your images
</span>    <span class="n">target_size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>
    <span class="n">class_mode</span><span class="o">=</span><span class="s">"binary"</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="convnet-with-imagegenerator">ConvNet with ImageGenerator</h3>

<p>More docs:</p>

<ul>
  <li><a href="https://gombru.github.io/2018/05/23/cross_entropy_loss/">Understanding Categorical Cross-Entropy Loss, Binary Cross-Entropy Loss, Softmax Loss, Logistic Loss, Focal Loss and all those confusing names</a></li>
  <li><a href="http://www.cs.toronto.edu/~tijmen/csc321/slides/lecture_slides_lec6.pdf">Overview of mini-batch gradient descent</a></li>
</ul>



<!-- <div class="box-error">
<h4>Notice an error?</h4>
Everything on this site is <a href="https://github.com/dinhanhthi/dinhanhthi.com" target="_blank">published</a> on Github. If you find something wrong, <a href="https://github.com/dinhanhthi/dinhanhthi.com/edit/master/_posts/mooc/2020-07-26-deeplearning-ai-tensorflow-course-1.md" target="_blank">just edit it</a> or <a href="mailto:dinhanhthi@gmail.com?subject=Suggest to edit post 'TF 1 - Intro to TensorFlow for AI, ML, DL'">tell me</a> about it.
</div> -->

<div class="sec-comment">

  

  <button class="btn btn-info w-100" id="show-comments" onclick="load_comment();return false;">
    If you find something wrong or need a comment, click here.
  </button>

  <div id='comment-box' style="display: none;">
    <script src="https://utteranc.es/client.js"
            repo="dinhanhthi/dinhanhthi.com"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
  </div>

  <script>
    var comment_loaded = false;
    function load_comment() {
        if (!comment_loaded)  {
            comment_loaded = true;
            document.getElementById("show-comments").style.display = "none";
            document.getElementById("comment-box").style.display = "block";
        }
    }
  </script>
</div>

<div class="modal fade" id="imagemodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg modal-xl">
    <div class="modal-content">
      <div class="modal-body">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <img src="" class="imagepreview" style="width: 100%;" >
      </div>
    </div>
  </div>
</div>



          </article >
        </div>
      </div>
    </div>
  </section>
</main>



  <footer class="footer">
    <div class="container">
  <div class="row justify-content-center">
    <div class="col-12 col-md-8 col-lg-6 text-center p-3">
      <div class="footer-info">
        <a href="https://dinhanhthi.com" target="_blank">Thi</a>
        &nbsp;&copy;&nbsp;
        2022
        &nbsp;&bull;&nbsp;
        <a href="http://localhost:4000/about-the-notes">
          About the notes
        </a>
        &nbsp;&bull;&nbsp;
        <a href="https://pobo.dinhanhthi.com" target="_blank">
          Po Bo
        </a>
        &nbsp;&bull;&nbsp;
        <a href="/for-me-only">
          For me only
        </a>
        &nbsp;&bull;&nbsp;
        <a class="donate" href="http://localhost:4000/donate">
          Support Thi
        </a>
      </div>
    </div>
  </div>
</div>

  </footer>

  





  
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
		ga('create', 'UA-58921685-1', 'auto');
		ga('send', 'pageview');
	</script>
	<!-- End Google Analytics -->


  <script src="https://code.jquery.com/jquery-1.10.1.min.js" integrity="sha256-SDf34fFWX/ZnUozXXEH0AeB+Ip3hvRsjLwp6QNTEb3k=" crossorigin="anonymous" async></script>

  <!-- scrolling-toc -->
  <script src="http://localhost:4000/js/scrolling-toc.js" type="text/javascript" async></script>

  <!-- bootstrap -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous" async></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous" async></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous" async></script>

  <script src="http://localhost:4000/js/click_to_zoom.js" async></script>

  <script src="http://localhost:4000/js/anchor.js" async></script>

</body>
</html>
